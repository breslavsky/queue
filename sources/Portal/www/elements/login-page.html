<link rel="import" href="/content/components/polymer/polymer.html">
<link rel="import" href="/content/components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="/content/components/paper-input/paper-input.html">
<link rel="import" href="/content/components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/content/components/paper-menu/paper-menu.html">

<dom-module id="login-page">
    <style is="custom-style">
        #container {
            margin: 10px;
        }    
        
        div[title] {
            font-weight: bold;
        }

        paper-input {
            margin-left: 5px;

        }   
    </style>

    <template>
    
        <div id="container" class="horizontal layout end">
            <paper-dropdown-menu label="Пользователь">
                <paper-menu class="dropdown-content" selected="{{selected}}">
                  <template is="dom-repeat" items="[[users]]">
                    <paper-tab>[[item.Presentation]]</paper-tab>
                  </template>
                </paper-menu>
            </paper-dropdown-menu>
            <paper-input label="Пароль" value="{{password}}"></paper-input>
            <paper-button primary raised on-click="login">Войти</paper-button>
        </div>   

    </template>
</dom-module>

<script>

    Polymer({
        is: 'login-page',

        ready: function () {

            var self = this;

            $.ajax({
                url: "http://localhost:4506/user/get-user-links",
                data: { userRole: "Operator" }
            }).done(function (operators) {
                self.users = operators;
            });
        },

        login: function () {

            var self = this;

            $.ajax({
                url: "http://localhost:4506/user/login",
                data: { userId: this.userId, password: this.password }
            }).done(function (operator) {
                console.log(operator);
            });
        },

        userIdCompute: function (selected) {
            if (this.users.length > 0) {
                return this.users[selected].Id;
            }
        },

        properties: {

            users: {
                type: Array,
                value: []
            },

            selected: {
                type: Number,
                value: -1
            },

            userId: {
                type: String,
                value: "",
                computed: "userIdCompute(selected)"
            },

            password: {
                type: String,
                value: ""
            }
        }
    });
</script>